<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>家庭成员关系图绘制系统</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="shortcut icon" href="/static/base/images/logo.png">
    <link rel="stylesheet" href="/static/admin/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/fonts/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/ionicons/css/ionicons.min.css">
    <link rel="stylesheet" href="/static/admin/dist/css/AdminLTE.min.css">
    <link rel="stylesheet" href="/static/admin/dist/css/skins/_all-skins.min.css">
    <link rel="stylesheet" href="/static/base/css/animate.css">
    <link rel="stylesheet" type="text/css" href="/static/admin/plugins/datepicker/datepicker3.css">
     <link rel="stylesheet" type="text/css" href="/static/base/css/style.css"/>
    <style>
        *{
            font-family:"Microsoft YaHei";
        }
        .table>tbody>tr>td, .table>tbody>tr>th, .table>tfoot>tr>td, .table>tfoot>tr>th, .table>thead>tr>td, .table>thead>tr>th{
            vertical-align:middle;
            text-align:center;
        }

    </style>

</head>
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">
    <header class="main-header">
        <a href="index.html" class="logo">
            <span class="logo-mini"><img src="/static/base/images/logo.png"
                                         style="height:40px;width:40px;">xxxxxxxxxx</span>
            <span class="logo-lg"><img src="/static/base/images/logo.png"
                                       style="height:40px;width:40px;">xxxxxx</span>
        </a>
        <nav class="navbar navbar-static-top">
            <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                <span class="sr-only">下拉菜单</span>
            </a>
            <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">
                    <li class="dropdown user user-menu">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <img src="/static/admin/dist/img/user2-160x160.jpg"
                                 class="user-image" alt="User Image">
                            <span class="hidden-xs">xxx</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li class="user-header">
                                <img src="/static/admin/dist/img/user2-160x160.jpg"
                                     class="img-circle" alt="User Image">
                                <p>
                                    xxx
                                    <small>2019-01-18</small>
                                </p>
                            </li>
                            <li class="user-footer">
                                <div class="pull-left">
                                    <a href="pwd.html" class="btn btn-default btn-flat">修改密码</a>
                                </div>
                                <div class="pull-right">
                                    <a href="login.html" class="btn btn-default btn-flat">退出系统</a>
                                </div>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>
    </header>


        <aside class="main-sidebar">
        <section class="sidebar">
            <div class="user-panel">
                <div class="pull-left image">
                    <img src="/static/admin/dist/img/user2-160x160.jpg" class="img-circle"
                         alt="User Image">
                </div>
                <div class="pull-left info">
                    <p>用户</p>
                    <a href="#"><i class="fa fa-circle text-success"></i> 在线</a>
                </div>
            </div>
            <form action="#" method="get" class="sidebar-form">
                <div class="input-group">
                    <input type="text" name="q" class="form-control" placeholder="搜索...">
                    <span class="input-group-btn">
                        <button type="submit" name="search" id="search-btn" class="btn btn-flat"><i
                                class="fa fa-search"></i>
                        </button>
                    </span>
                </div>
            </form>
            <ul class="sidebar-menu">
                <li class="header">管理菜单</li>
                <li class="treeview">
                    <a href="#">
                        <i class="fa fa-home" aria-hidden="true"></i>
                        <span>首页</span>
                        <span class="label label-primary pull-right">1</span>
                    </a>
                    <ul class="treeview-menu">
                        <li>
                            <a href="/#/">
                                <i class="fa fa-circle-o"></i> 人流量统计
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="treeview">
                    <a href="#">
                        <i class="fa fa-tags" aria-hidden="true"></i>
                        <span>个人信息</span>
                        <span class="label label-primary pull-right">1</span>
                    </a>
                    <ul class="treeview-menu">
                        <li>
                            <a href="/userview/">
                                <i class="fa fa-circle-o"></i> 详细信息
                            </a>
                        </li>
                        <li>
                            <a href="/user_relations/">
                                <i class="fa fa-circle-o"></i> 关系图
                            </a>
                        </li>
                                                <li>
                            <a href="/user_tree/">
                                <i class="fa fa-circle-o"></i> 家谱树
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="treeview">
                    <a href="#">
                        <i class="fa fa-file-text" aria-hidden="true"></i>
                        <span>多媒体信息</span>
                        <span class="label label-primary pull-right">2</span>
                    </a>
                    <ul class="treeview-menu">
                        <li>
                            <a href="/imageswall/">
                                <i class="fa fa-circle-o"></i>个人照片墙
                            </a>
                        </li>
                        <li>
                            <a href="/vediowall/">
                                <i class="fa fa-circle-o"></i> 视频
                            </a>
                        </li>
{#                        <li>#}
{#                            <a href="/userloginlog_list/">#}
{#                                <i class="fa fa-circle-o"></i> 会员登录日志列表#}
{#                            </a>#}
{#                        </li>#}
                    </ul>
                </li>
                <li class="treeview">
                    <a href="#">
                        <i class="fa fa-lock" aria-hidden="true"></i>
                        <span>亲戚称谓计算</span>
                        <span class="label label-primary pull-right">1</span>
                    </a>
                    <ul class="treeview-menu">
                        <li>
                            <a href="#">
                                <i class="fa fa-circle-o"></i> 亲戚称谓计算
                            </a>
                        </li>
{#                        <li>#}
{#                            <a href="/auth_list/">#}
{#                                <i class="fa fa-circle-o"></i> 权限列表#}
{#                            </a>#}
{#                        </li>#}
                    </ul>
                </li>
                <li class="treeview">
                    <a href="#">
                        <i class="fa fa-user-secret" aria-hidden="true"></i>
                        <span>日志管理</span>
                        <span class="label label-primary pull-right">2</span>
                    </a>
                    <ul class="treeview-menu">
                        <li>
                            <a href="#">
                                <i class="fa fa-circle-o"></i>登陆日志
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fa fa-circle-o"></i> 操作日志
                            </a>
                        </li>
                    </ul>
                </li>
{#                <li class="treeview">#}
{#                    <a href="#">#}
{#                        <i class="fa fa-user-circle" aria-hidden="true"></i>#}
{#                        <span>管理员管理</span>#}
{#                        <span class="label label-primary pull-right">2</span>#}
{#                    </a>#}
{#                    <ul class="treeview-menu">#}
{#                        <li>#}
{#                            <a href="/admin_add/">#}
{#                                <i class="fa fa-circle-o"></i> 添加管理员#}
{#                            </a>#}
{#                        </li>#}
{#                        <li>#}
{#                            <a href="/admin_list/">#}
{#                                <i class="fa fa-circle-o"></i> 管理员列表#}
{#                            </a>#}
{#                        </li>#}
{#                    </ul>#}
{#                </li>#}

            </ul>
        </section>
    </aside>



{% block content %}
        <!--内容-->
     <div class="content-wrapper">
        <section class="content-header">
            <h1>家庭成员关系图绘制系统</h1>
            <ol class="breadcrumb">
                <li><a href="#"><i class="fa fa-dashboard"></i> 会员管理</a></li>
                <li class="active">会员列表</li>
            </ol>
        </section>
        <section class="content" id="showcontent">
            <div class="row">
                <div class="col-md-12">
                    <div class="box box-primary">
                        <div class="box-header">
                            <h3 class="box-title">会员列表</h3>
                            <div class="box-tools">
                                <div class="input-group input-group-sm" style="width: 150px;">
                                    <input type="text" name="table_search" class="form-control pull-right"
                                           placeholder="请输入关键字...">

                                    <div class="input-group-btn">
                                        <button type="submit" class="btn btn-default"><i class="fa fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box-body table-responsive no-padding">
                            <table class="table table-hover">
                                <tbody>
                                <tr>
                                    <th>编号</th>
                                    <th>真实姓名</th>
                                    <th>昵称</th>
                                    <th>姓氏</th>
                                    <th>性别</th>
                                    <th>出生日期</th>
                                    <th>手机号码</th>
                                    <th>邮箱</th>
                                    <th>头像</th>
                                    <th>籍贯</th>
                                    <th>注册时间</th>
                                    <th>操作事项</th>
                                </tr>
                                {% for one in userlist %}
                                <tr>
                                    <td>{{ one.id }}</td>
                                    <td>{{ one.name }}</td>
                                    <td>{{ one.nickname }}</td>
                                    <td>{{ one.xingshi}}</td>
                                    <td>{{ one.sex }}</td>
                                    <td>{{ one.birthday }}</td>
                                    <td>{{ one.phone }}</td>
                                    <td>{{ one.email }}</td>
                                    <td>
                                        {% if one.image %}
                                        <img src="{{ one.image }}" class="img-responsive center-block" alt="">
                                        {% else %}
                                            <img src="#" class="img-responsive center-block" alt="">
                                        {% endif %}
                                    </td>
                                    <td>{{ one.jiguan }}</td>
                                    <td>{{ one.register_time }}</td>
                                    <td>
                                        <a class="label label-success" href="/user_view/{{ one.id }}">查看</a>
                                        &nbsp;
                                        <a class="label label-info">解冻</a>
                                        &nbsp;
                                        <a class="label label-warning">冻结</a>
                                        &nbsp;
                                        <a class="label label-danger">删除</a>
                                    </td>
                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <div class="box-footer clearfix">
                            <ul class="pagination pagination-sm no-margin pull-right">
                                <li><a href="#">首页</a></li>
                                <li><a href="#">上一页</a></li>
                                <li><a href="#">1</a></li>
                                <li><a href="#">2</a></li>
                                <li><a href="#">3</a></li>
                                <li><a href="#">下一页</a></li>
                                <li><a href="#">尾页</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--内容-->
    </div>
{% endblock %}




{#    <div class="content-wrapper">#}
        <!--内容-->
{#        <section class="content-header">#}
{#            <h1>航程计算管理</h1>#}
{#            <ol class="breadcrumb">#}
{#                <li><a href="#"><i class="fa fa-dashboard"></i> 首页</a></li>#}
{#                <li class="active">控制面板</li>#}
{#            </ol>#}
{#        </section>#}
{#        <section class="content" id="showcontent">#}
{#            <div class="row">#}
{#                <div class="col-md-6">#}
{#                    <div class="box box-primary">#}
{#                        <div class="box-header with-border">#}
{#                            <h3 class="box-title">内存使用率</h3>#}
{#                        </div>#}
{#                        <div class="box-body" id="meminfo" style="height:600px;"></div>#}
{#                    </div>#}
{#                </div>#}
{#                <div class="col-md-6">#}
{#                    <div class="box box-primary">#}
{#                        <div class="box-header with-border">#}
{#                            <h3 class="box-title">系统设置</h3>#}
{#                        </div>#}
{#                        <form role="form">#}
{#                            <div class="box-body" style="height:600px;">#}
{#                                <div class="form-group">#}
{#                                    <label for="input_speed">限制速率大小</label>#}
{#                                    <input type="text" class="form-control" id="input_speed" placeholder="请输入限制速率！"#}
{#                                           value="512">#}
{#                                </div>#}
{#                                <div class="form-group">#}
{#                                    <label for="input_mem">限制内存大小</label>#}
{#                                    <input type="text" class="form-control" id="input_mem" placeholder="请输入限制内存！"#}
{#                                           value="10m">#}
{#                                </div>#}
{#                                <div class="form-group">#}
{#                                    <label for="input_num">限制客户端数量</label>#}
{#                                    <input type="text" class="form-control" id="input_num" placeholder="请输入限制客户端数量！"#}
{#                                           value="4">#}
{#                                </div>#}
{#                                <div class="form-group">#}
{#                                    <button type="submit" class="btn btn-primary">保存并重启服务</button>#}
{#                                </div>#}
{#                            </div>#}
{#                        </form>#}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
{#        </section>#}
        <!--内容-->
{#    </div>#}
    <footer class="main-footer">
        <div class="pull-right hidden-xs">
            <b>版本</b> 1.0
        </div>
        <strong>版权 &copy; 2017-2018 归<a href="">xxx</a>.</strong> 所有
    </footer>
    <div class="control-sidebar-bg"></div>
</div>
<script src="/static/admin/plugins/jQuery/jQuery-2.2.0.min.js"></script>
<script src="/static/admin/bootstrap/js/bootstrap.min.js"></script>
<script src="/static/admin/plugins/slimScroll/jquery.slimscroll.min.js"></script>
<script src="/static/admin/plugins/fastclick/fastclick.js"></script>
<script src="/static/admin/dist/js/app.min.js"></script>
<script src="/static/admin/dist/js/demo.js"></script>
<script src="//cdn.bootcss.com/holder/2.9.4/holder.min.js"></script>
<script src="/static/admin/plugins/datepicker/bootstrap-datepicker.js"></script>
<script src="/static/admin/plugins/datepicker/locales/bootstrap-datepicker.zh-CN.js" charset="UTF-8"></script>
<script src="/static/js/echarts.min.js"></script>
<script src="/static/js/jquery.hDialog.js"></script>
{#<script src="/static/js/jquery.min.js"></script>#}
{##}

<script>

	function Node(id){
		this.together = false ;
		this.id = id ;
		this.me = false ;
		this.dead = false ;
		this.sex = 0 ;
		this.age = null ;
		this.couple = null ;
		this.father = null ;
		this.mother = null ;
		this.children = [] ;
		this.x = null ;
		this.y = null ;
	}


</script>
<script>
	var c = document.getElementById('myCanvas') ;
	var ctx = c.getContext("2d");
    var img=new Image();
    img.src='';
	var dragspeed = 0.01 ;
	var mouse_press = false ;
	var press_mouse_x ;
	var press_mouse_y ;
	var move_x = 0 ;
	var move_y = 0 ;
	var moved_x = 0 ;
	var moved_y = 0 ;
	var mouse_x = 0, mouse_y = 0;
	var baselong = 0 , baselati = 0 ;
	var offsetx = 18 , offsety = 18 , offsetsize = 15 ;
	var size = 20 ;
	var node_vertical_distance = 115 ;
	var child_horizontal_distance = 100 ;
	var NodeList = [] ;
	var PaintedNode = [] ;
	var LevelOrderNode = [[]] ;
	var NowId = null ;
	var cover_distance = 10 ;
	var demoved = 0 ;
	var couple_distance = 100 ;
	ctx.lineWidth = 2 ;
	ctx.fillStyle = "white" ;
	var HighestList = [];
	var SecondList = [];
	var LowestList = [];
	var HighestLeft , HighestRight ;
	var SecondLeft , SecondRight ;
	var LowestLeft , LowestRight ;

	$("#myCanvas").mousedown(function (e) {
		press_mouse_x = mouse_x;
		press_mouse_y = mouse_y;
		mouse_press = true ;
        console.log('down');
	});

	$("#myCanvas").mouseup(function (e) {
		moved_x += move_x ;
		moved_y += move_y ;
		move_x = 0 ;
		move_y = 0 ;
		mouse_press = false ;
		Paint2();
		press_mouse_x = 0 ;
		press_mouse_y = 0 ;
         console.log('up');

 	});

	$("#myCanvas").mousemove(function (e) {
{#        console.log(e.pageX);#}
{#        console.log(e.pageY);#}
		mouse_x = e.pageX + document.documentElement.scrollTop;
		mouse_y = e.pageY + document.documentElement.scrollLeft;
{#        console.log(mouse_x);#}
{#        console.log(mouse_y);#}
		if ( mouse_press === true ){
			move_x = mouse_x-press_mouse_x ;
			move_y = mouse_y-press_mouse_y ;
{#			ctx.clearRect ( (-1)*c.width , (-1)*c.height , c.width*2, c.height*2 );#}
{#			ctx.clearRect (0 , 0 , c.width, c.height );#}

{#            ctx.clearRect(0, 0, 1230,880);#}
			Paint2();
		}
	});


	$('#myCanvas').click(function (e) {
        //console.log('click');
       // console.log(NodeList);
        //console.log(e.pageX);
        //console.log(e.pageY);
		mouse_x = e.pageX + document.documentElement.scrollTop;
        mouse_y = e.pageY + document.documentElement.scrollLeft;
        console.log('123');
		for ( var i = 0 ; i < NodeList.length ; i ++ ) {
			if ( Math.abs(mouse_x - NodeList[i].x -230-(move_x+moved_x) )  <= size && Math.abs(mouse_y - NodeList[i].y -90-(move_y+moved_y) ) <= size ) {
				NowId = NodeList[i].id ;
                console.log('当前选中节点'+NowId);
				$('#age').val(NodeList[NowId].age);
{#                ctx.clearRect ( 0 , 0 , c.width, c.height );#}
				Paint2();
				return ;
			}
		}
		NowId = null ;
		Paint2();
	});


    	$('#myCanvas').dblclick(function (e) {
            mouse_x = e.pageX + document.documentElement.scrollTop;
            mouse_y = e.pageY + document.documentElement.scrollLeft;
		    for ( var i = 0 ; i < NodeList.length ; i ++ ) {
			if ( Math.abs(mouse_x - NodeList[i].x -230-(move_x+moved_x) )  <= size && Math.abs(mouse_y - NodeList[i].y -90-(move_y+moved_y) ) <= size ) {
				NowId = NodeList[i].id ;
                console.log('当前选中节点'+NowId);
				$('#age').val(NodeList[NowId].age);
                 $('.dialog').click();
                console.log('双击');
{#               ctx.clearRect ( 0 , 0 , c.width, c.height );#}
                c = document.getElementById('myCanvas') ;
                ctx = c.getContext("2d");
				Paint2();
				return ;
			}
		}
		NowId = null ;
		Paint2();



	});


	$('#age').keyup(function(){
		if ( DetectNull() === true){
			NodeList[NowId].age = $(this).val();
			Paint2();
		}
	});

	$('#changedead').click(function (e) {
		if ( DetectNull() === true){
			if ( NodeList[NowId].dead === true )
				NodeList[NowId].dead = false ;
			else
				NodeList[NowId].dead = true ;
			Paint();
		}
	});

	$('#changetogether').click(function (e) {
		if ( DetectNull() === true){
			if ( NodeList[NowId].together === true )
				NodeList[NowId].together = false ;
			else
				NodeList[NowId].together = true ;
			Paint();
		}
	});

	$('#changeme').click(function (e) {
		if ( DetectNull() === true){
			for ( var i = 0 ; i < NodeList.length ; i ++ ){
				NodeList[i].me = false ;
			}
			NodeList[NowId].me = true ;
			Paint();
		}
	});

	$('#reset').click(function (e) {
		Init();
	});

	$('#changesex').click(function (e) {
		if ( DetectNull() === true){
			if ( NodeList[NowId].couple !== null ){
				alert("已有伴侶無法更改") ;
				return ;
			}
			NodeList[NowId].sex = 1 - NodeList[NowId].sex ;
			Paint();
		}
	});

	$('#insertchild_back').click(function (e) {
		InsertChildBack();
	});

	$('#insertchild_front').click(function (e) {
		InserChildFront();
	});

    $('#insertparent').click(function (e) {
		InsertParent();
	});

    $('#insertcouple').click(function (e) {
		InsertCouple();
	});

	var InsertParent = function(){
		if ( DetectNull() === true ){
			if ( NodeList[NowId].father !== null && NodeList[NowId].mother !== null){
				alert("已有家長") ;
			} else {
				var father = new Node(NodeList.length) ;
				father.children.push(NodeList[NowId]) ;
				father.sex = 1 ;
				var mother = new Node(NodeList.length+1) ;
				mother.children.push(NodeList[NowId]) ;
				mother.sex = 0 ;
				father.couple = mother ;
				mother.couple = father ;
				NodeList.push(father) ;
				NodeList.push(mother) ;
				NodeList[NowId].father = father ;
				NodeList[NowId].mother = mother ;
				Paint();
			}
		}
	}


	var InsertCouple = function(){
		if ( DetectNull() === true){
			if ( NodeList[NowId].couple !== null ){
				alert("重婚") ;
			} else {
				var coupleNode = new Node(NodeList.length) ;
				coupleNode.sex = ( 1 - NodeList[NowId].sex ) ;
				coupleNode.couple = NodeList[NowId] ;
				NodeList.push(coupleNode) ;
				NodeList[NowId].couple = coupleNode ;
				NodeList[coupleNode.id].couple = NodeList[NowId] ;
				Paint();
			}
		}
	}

	var InsertChildBack = function(){
		if ( DetectNull() === true){
			if ( NodeList[NowId].couple === null ){
				alert("沒有伴侶") ;
			} else {
				var child = new Node(NodeList.length) ;
				NodeList.push(child) ;
				if ( NodeList[NowId].sex === 0 ) {
					NodeList[child.id].mother = NodeList[NowId];
					NodeList[child.id].father = NodeList[NowId].couple ;
				} else {
					NodeList[child.id].father = NodeList[NowId];
					NodeList[child.id].mother = NodeList[NowId].couple ;
				}
				NodeList[NowId].children.push(child) ;
				NodeList[NodeList[NowId].couple.id].children.push(child) ;
				Paint();
			}
		}
	}

	var InserChildFront = function(){
		if ( DetectNull() === true){
			if ( NodeList[NowId].couple === null ){
				alert("沒有伴侶") ;
			} else {
				var child = new Node(NodeList.length) ;
				NodeList.push(child) ;
				if ( NodeList[NowId].sex === 0 ) {
					NodeList[child.id].mother = NodeList[NowId];
					NodeList[child.id].father = NodeList[NowId].couple ;
				} else {
					NodeList[child.id].father = NodeList[NowId];
					NodeList[child.id].mother = NodeList[NowId].couple ;
				}
				NodeList[NowId].children.unshift(child) ;
				NodeList[NodeList[NowId].couple.id].children.unshift(child) ;
				Paint();
			}
		}
	}

	var DetectNull = function(){
		if (NowId === null){
			alert("請選擇人物") ;
			return false ;
		}
		return true ;
	}

	var ResetParentSite = function(index){
		if ( ( NodeList[index].father === null &&  NodeList[index].mother === null ) || PaintedNode[index] === true ){
			return ;
		}
		NodeList[NodeList[index].father.id].x = NodeList[index].x - couple_distance / 2 ;
		NodeList[NodeList[index].mother.id].x = NodeList[index].x + couple_distance / 2 ;
		NodeList[NodeList[index].father.id].y = NodeList[index].y - node_vertical_distance ;
		NodeList[NodeList[index].mother.id].y = NodeList[index].y - node_vertical_distance ;
		ResetParentSite(NodeList[index].father.id);
		ResetParentSite(NodeList[index].mother.id);
		ResetChildrenSite(NodeList[index].mother.id);
	};

	var ResetChildrenSite = function(index){
		if ( NodeList[index].children.length === 0 || PaintedNode[index] === true )
			return ;
		PaintedNode[index] = true ;
		if ( NodeList[index].sex === 0 ){
			for ( var i = 0 ; i < NodeList[index].children.length ; i ++ ){
				ResetCoupleSite(NodeList[index].children[i].id) ;
				NodeList[NodeList[index].children[i].id].x = (-1)*child_horizontal_distance / 2 + NodeList[index].x + ( child_horizontal_distance * i ) - ( NodeList[index].children.length - 1 ) * child_horizontal_distance / 2 ;
				NodeList[NodeList[index].children[i].id].y = NodeList[index].y + node_vertical_distance ;
				ResetChildrenSite(NodeList[index].children[i].id) ;
			}
		} else {
			for ( var i = 0 ; i < NodeList[index].children.length ; i ++ ){
				ResetCoupleSite(NodeList[index].children[i].id) ;
				NodeList[NodeList[index].children[i].id].x = (child_horizontal_distance / 2) + NodeList[index].x + ( child_horizontal_distance * i ) - ( NodeList[index].children.length - 1 ) * child_horizontal_distance / 2 ;
				NodeList[NodeList[index].children[i].id].y = NodeList[index].y + node_vertical_distance ;
				ResetChildrenSite(NodeList[index].children[i].id) ;
			}
		}
	};

	var ResetCoupleSite = function(index){
		if ( NodeList[index].couple === null || PaintedNode[index] === true ){
			return ;
		}
		NodeList[NodeList[index].couple.id].y = NodeList[index].y ;
		if ( NodeList[index].sex === 0 ) {
			NodeList[NodeList[index].couple.id].x = NodeList[index].x - couple_distance ;
		} else {
			NodeList[NodeList[index].couple.id].x = NodeList[index].x + couple_distance ;
		}
		ResetParentSite(NodeList[index].couple.id);
		ResetChildrenSite(NodeList[index].couple.id);
	};

	var ResetAllSite = function(){
		NodeList[0].x = c.width/2 ;
		ResetParentSite(0);
		ResetCoupleSite(0);
		ResetChildrenSite(0);
	};

	var Paint = function(){
		PaintedNode = new Array();
		for ( var i = 0 ; i < NodeList.length ; i ++ ){
			PaintedNode.push(false) ;
		}
		ResetAllSite();
		DetectAllCover();
		Paint2();
	};

	var DetectLevel = function(offset){
		var move = offset ;
		var moved = false ;
		for ( var i = 0 ; i < HighestList.length ; i ++ ){
			NodeList[HighestList[i]].x += move ;
			NodeList[NodeList[HighestList[i]].couple.id].x += move ;
			if ( moved === true ){
				for ( var j = 0 ; j < NodeList[HighestList[i]].children.length ; j ++ )
					NodeList[NodeList[HighestList[i]].children[j].id].x += move ;
				moved = false ;
			}
			for ( var j = i + 1 ; j < HighestList.length ; j ++ ){
				if ( Math.abs(NodeList[HighestList[i]].x -  NodeList[HighestList[j]].x) <= child_horizontal_distance ) {
					move += child_horizontal_distance ;
					moved = true ;
				}
			}
		}
		move = offset ;
		moved = false ;
		for ( var i = 0 ; i < HighestList.length ; i ++ ){
			NodeList[HighestList[i]].x += move ;
			NodeList[NodeList[HighestList[i]].couple.id].x += move ;
			if ( moved === true ){
				for ( var j = 0 ; j < NodeList[HighestList[i]].children.length ; j ++ )
					NodeList[NodeList[HighestList[i]].children[j].id].x += move ;
				moved = false ;
			}
			for ( var j = 0 ; j < NodeList[HighestList[i]].children.length ; j ++ ){
				for ( var k = i + 1 ; k < HighestList.length ; k ++ ) {
					if ( NodeList[HighestList[i]].children[j].x >= NodeList[HighestList[k]].children[0].x - child_horizontal_distance / 2 ){
						move += child_horizontal_distance ;
						moved = true ;
					}
				}
			}
		}
		FixChildren(0) ;
		SecondList = new Array();
		LowestList = new Array();
		if ( HighestList.length > 0 ){
			for ( var j = 0 ; j < NodeList[HighestList[0]].children.length ; j ++ ){
				SecondList.push(NodeList[HighestList[0]].children[j].id) ;
			}
			for ( var j = 0 ; j < NodeList[HighestList[1]].children.length ; j ++ ){
				SecondList.push(NodeList[HighestList[1]].children[j].id) ;
			}
			for ( var j = 0 ; j < NodeList[0].children.length ; j ++ ){
				LowestList.push(NodeList[0].children[j].id) ;
			}
		}
		for ( var i = 0 ; i < HighestList.length ; i ++ ){
			if ( HighestLeft === null ){
				HighestLeft = HighestList[i].x ;
				HighestRight = HighestList[i].x ;
			} else if ( HighestLeft !== null ){
				HighestRight = HighestList[i].x ;
			}
		}
		for ( var i = 0 ; i < SecondList.length ; i ++ ){
			if ( SecondLeft === null ){
				SecondLeft = SecondList[i].x ;
				SecondRight = SecondList[i].x ;
			} else if ( SecondLeft !== null ){
				SecondRight = SecondList[i].x ;
			}
		}
		for ( var i = 0 ; i < LowestList.length ; i ++ ){
			if ( LowestLeft === null ){
				LowestLeft = LowestList[i].x ;
				LowestRight = LowestList[i].x ;
			} else if ( HighestLeft !== null ){
				LowestRight = LowestList[i].x ;
			}
		}
	}

	var DetectAllCover = function(){
		DetectLevel(0);
		/*
		var ysite = 99999 , highestid ;
		for ( var i = 0 ; i < NodeList.length ; i ++ ) {
			if ( ysite > NodeList[i].y ){
				ysite = NodeList[i].y ;
				highestid = i ;
			}
		}
		HighestList = [];
		for ( var i = 0 ; i < NodeList.length ; i ++ ){
			if ( NodeList[i].y === ysite && NodeList[i].sex === 1 ){
				HighestList.push(i) ;
			}
		}
		var LevelOrderNode = [[]] ;
		var SortedList = NodeList ;
		SortedList.sort(function(a, b){return a.y-b.y});
		var ysite = SortedList[0] ;
		for ( var i = 0 , j = 0 ; i < SortedList.length ; i ++ ){
			if ( SortedList[i] === ysite ){
				LevelOrderNode[j].push()
			}
		}
		/*
		var Fixed = false ;
		for ( var i = 0 ; i < NodeList.length ; i ++ ){
			while ( DetectCover(i) === true ){
				DetectCover(i) ;
				Fixed = true ;
			}
		}*/
		//FixCouple();
		//FixSoloChild();
	};

	var Paint2 = function(){
        console.log(NodeList);
{#		ctx.clearRect ( (-1)*c.width , (-1)*c.height , c.width*2, c.height*2 );#}
		ctx.clearRect ( 0 , 0 , 1230, 880 );
{#        c.width=1230;#}
{#        c.height=880;#}
{#        ctx.beginPath();#}
		ctx.font = "30px Arial";
		ctx.fillStyle = "#000000";
{#		ctx.fillText("By : jeno5980515", 600, 600);#}
		for ( var i = 0 ; i < NodeList.length ; i ++ ){
            console.log('画'+NodeList[i]);
			if ( NodeList[i].x === null || NodeList[i].y === null ) {
				alert("Bug") ;
				break ;
			}
			ctx.strokeStyle = "black" ;
			if ( NodeList[i].id === NowId ){
                    ctx.strokeStyle = "red" ;
			}
			if ( NodeList[i].dead == false ){
				if ( NodeList[i].sex === 0 ){
					ctx.beginPath();
					ctx.arc(NodeList[i].x+move_x+moved_x,NodeList[i].y+move_y+moved_y,size,0,Math.PI*2);
					ctx.stroke() ;
					if ( NodeList[i].me === true ){
						ctx.beginPath();
						ctx.moveTo( NodeList[i].x+size-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
						ctx.lineTo( NodeList[i].x-size/2+1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
						ctx.moveTo( NodeList[i].x+size-5-1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size-5+1+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
						ctx.lineTo( NodeList[i].x-size/2-5+1+1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1-5-1 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
						ctx.moveTo( NodeList[i].x+size+5-1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size+5+1+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
						ctx.lineTo( NodeList[i].x-size/2+5+1+1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1+5-1 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
						ctx.moveTo( NodeList[i].x+size-10-1-3-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size-10+1+3+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
						ctx.lineTo( NodeList[i].x-size/2-10+1+1+3-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1-10-1-3 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
						ctx.moveTo( NodeList[i].x+size+10-1-3-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size+10+1+3+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
						ctx.lineTo( NodeList[i].x-size/2+10+1+1+3-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1+10-1-3 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
						ctx.stroke() ;
					}
				} else {
					ctx.beginPath();
					ctx.strokeRect(NodeList[i].x-offsetx+move_x+moved_x,NodeList[i].y-offsety+move_y+moved_y,size+offsetsize,size+offsetsize);
					if ( NodeList[i].me === true ){
						ctx.beginPath();
						ctx.moveTo( NodeList[i].x+size+2-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size-2+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
						ctx.lineTo( NodeList[i].x-size/2+1-2-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1+2 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
						ctx.moveTo( NodeList[i].x+size-5-1-1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size-5+1+1+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
						ctx.lineTo( NodeList[i].x-size/2-5+1+1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1-5-1-1+ +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
						ctx.moveTo( NodeList[i].x+size+5-1-1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size+5+1+1+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
						ctx.lineTo( NodeList[i].x-size/2+5+1+1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1+5-1-1 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
						ctx.moveTo( NodeList[i].x+size-10-1-3-2-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size-10+1+3+2+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
						ctx.lineTo( NodeList[i].x-size/2-10+1+1+3+1+1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1-10-1-3-1-1 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
						ctx.moveTo( NodeList[i].x+size+10-1-3-2-1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size+10+1+3+2+1+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
						ctx.lineTo( NodeList[i].x-size/2+10+1+1+3+1+2-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1+10-1-3-1-2 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
						ctx.stroke() ;
					}
				}
			} else {
				if ( NodeList[i].sex === 0 ){
					ctx.beginPath();
					ctx.arc(NodeList[i].x+move_x+moved_x,NodeList[i].y+move_y+moved_y,size,0,Math.PI*2);
					ctx.stroke() ;
					ctx.closePath();
					ctx.moveTo(0,0);
					ctx.beginPath();
					ctx.moveTo( NodeList[i].x-size+(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
					ctx.lineTo( NodeList[i].x+size/2-1+(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
					ctx.stroke() ;
					ctx.moveTo( NodeList[i].x+size-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-size+(size-Math.sqrt(size*size/2)) +move_y+moved_y) ;
					ctx.lineTo( NodeList[i].x-size/2+1-(size-Math.sqrt(size*size/2))+move_x+moved_x,  NodeList[i].y-1 +size/2+(size-Math.sqrt(size*size/2))+move_y+moved_y) ;
					ctx.stroke() ;
				} else {
					ctx.beginPath();
					ctx.strokeRect(NodeList[i].x-offsetx+move_x+moved_x,NodeList[i].y-offsety+move_y+moved_y,size+offsetsize,size+offsetsize);
					ctx.stroke() ;
					ctx.closePath();
					ctx.moveTo(0,0);
					ctx.beginPath();
					ctx.moveTo( NodeList[i].x-size+2+move_x+moved_x,  NodeList[i].y+2-size+move_y+moved_y) ;
					ctx.lineTo( NodeList[i].x+size-3+move_x+moved_x,  NodeList[i].y-3+size+move_y+moved_y) ;
					ctx.stroke() ;
					ctx.moveTo( NodeList[i].x+size-3+move_x+moved_x,  NodeList[i].y+2-size+move_y+moved_y) ;
					ctx.lineTo( NodeList[i].x-size+3+move_x+moved_x,  NodeList[i].y-3+size+move_y+moved_y) ;
					ctx.stroke() ;
				}
			}
			if ( NodeList[i].age !== null ){
				ctx.font = "20px Arial";
				ctx.fillText(NodeList[i].age, NodeList[i].x-size+move_x+moved_x+10, NodeList[i].y+size+move_y+moved_y+40);
			}
		}
		ctx.strokeStyle = "black" ;
		ctx.closePath();
		ctx.moveTo(0,0);
		ctx.beginPath();
		DrawLine();
	};

	var ver = function(index){
		var result = false ;
		for ( var i = 0 ; i < NodeList.length ; i ++ ){
			if ( i === index )
				continue ;
			if ( Math.abs(NodeList[i].x - NodeList[index].x) <= child_horizontal_distance / 2 && index !== i && NodeList[i].y === NodeList[index].y ){
				FixSite(index,i) ;
				result = true ;
				i = -1 ;
			}
		}
		if( result === true )
        {
			return true ;
        }
		else {
            return false;
        }
	}

	var FixParent = function(index){
		if ( NodeList[index].father === null || NodeList[NodeList[index].father.id].children.length === 0 )
			return ;
		var FatherId = NodeList[index].father.id , MotherId = NodeList[index].mother.id ;
		if ( Math.abs(NodeList[FatherId].x + NodeList[MotherId].x / 2 - NodeList[FatherId].children[Math.floor(NodeList[FatherId].children.length/2)].x) <= couple_distance ) {
			NodeList[FatherId].x = NodeList[FatherId].children[Math.floor(NodeList[FatherId].children.length/2)].x - couple_distance / 2 ;
			NodeList[MotherId].x = NodeList[MotherId].children[Math.floor(NodeList[MotherId].children.length/2)].x + couple_distance / 2 ;
		}
	};

	var FixChildren = function(index){
		var coveroffsetx = 0 ;
		if ( NodeList[index].sex === 0 ){
			for ( var i = 0 ; i < NodeList[index].children.length ; i ++ ){
				NodeList[NodeList[index].children[i].id].x = coveroffsetx +
				(-1)*Math.abs(NodeList[index].x - NodeList[NodeList[index].couple.id].x) / 2
				+ NodeList[index].x + ( Math.abs(NodeList[index].x - NodeList[NodeList[index].couple.id].x) * i / 2 ) -
				( NodeList[index].children.length - 1 ) * Math.abs(NodeList[index].x - NodeList[NodeList[index].couple.id].x) / 4 ;
				/*
				for ( var j = i + 1  ; j < NodeList[index].children.length ; j ++ ){
					if ( Math.abs(NodeList[NodeList[index].children[i].id].x-NodeList[NodeList[index].children[j].id].x) <= child_horizontal_distance / 2 ){
						if ( NodeList[NodeList[index].children[i].id].sex === 1 ) {
							if ( NodeList[NodeList[index].children[i].id].couple !== null ){
								NodeList[NodeList[index].children[i].id].x = NodeList[NodeList[index].children[i].id].x - couple_distance ;
								coveroffsetx += child_horizontal_distance ;
								NodeList[NodeList[NodeList[index].children[i].id].couple.id].x = NodeList[NodeList[index].children[i].id].x + couple_distance ;
							} else {
								coveroffsetx += child_horizontal_distance / 2  ;
							}
						} else {
							if ( NodeList[NodeList[index].children[i].id].couple !== null ){
								NodeList[NodeList[index].children[i].id].x = NodeList[NodeList[index].children[i].id].x + couple_distance ; ;
								NodeList[NodeList[NodeList[index].children[i].id].couple.id].x = NodeList[NodeList[index].children[i].id].x - couple_distance ;
								coveroffsetx += child_horizontal_distance ;
							} else {
								coveroffsetx += child_horizontal_distance /2 ;
							}
						}
					}
				}
				*/
			}
		}
	};


	var DrawCoupleLine = function(index){
		ctx.closePath();
		ctx.moveTo(0,0);
		ctx.beginPath();
		if ( NodeList[index].couple !== null ){
			if ( NodeList[index].sex === 1 ){
				ctx.moveTo(NodeList[index].x+move_x+moved_x,NodeList[index].y+move_y+moved_y+size-2);
				ctx.lineTo(NodeList[index].x+move_x+moved_x,NodeList[index].y+move_y+moved_y+node_vertical_distance*2/7);
				ctx.lineTo(NodeList[NodeList[index].couple.id].x+move_x+moved_x,NodeList[NodeList[index].couple.id].y+move_y+moved_y+node_vertical_distance*2/7);
				ctx.lineTo(NodeList[NodeList[index].couple.id].x+move_x+moved_x,NodeList[NodeList[index].couple.id].y+move_y+moved_y+size);
				ctx.stroke();
			}
		}
	};

	var DrawChildrenLine = function(index){
		ctx.closePath();
		ctx.moveTo(0,0);
		ctx.beginPath();
		if ( NodeList[index].couple !== null && NodeList[index].children.length !== 0 && NodeList[index].sex === 1 ){
			ctx.moveTo(NodeList[index].children[0].x+move_x+moved_x,NodeList[index].y+move_y+moved_y+node_vertical_distance*5/8);
			ctx.lineTo(NodeList[index].children[NodeList[index].children.length-1].x+move_x+moved_x,NodeList[NodeList[index].couple.id].y+move_y+moved_y+node_vertical_distance*5/8);
			for ( var i = 0 ; i < NodeList[index].children.length ; i ++ ){
				ctx.moveTo(NodeList[index].children[i].x+move_x+moved_x,NodeList[index].children[i].y+move_y+moved_y-node_vertical_distance*3/8);
				if ( NodeList[index].children[i].sex === 0 ){
					ctx.lineTo(NodeList[index].children[i].x+move_x+moved_x,NodeList[index].children[i].y+move_y+moved_y-size+1);
				} else {
					ctx.lineTo(NodeList[index].children[i].x+move_x+moved_x,NodeList[index].children[i].y+move_y+moved_y-size+1);
				}
			}
			ctx.moveTo((NodeList[NodeList[index].couple.id].x + NodeList[index].x)/2+move_x+moved_x,NodeList[index].y+move_y+moved_y+node_vertical_distance*2/7);
			ctx.lineTo((NodeList[NodeList[index].couple.id].x + NodeList[index].x)/2+move_x+moved_x,NodeList[index].y+move_y+moved_y+node_vertical_distance*5/8);
			ctx.stroke();
		}
	};

	var DrawLine = function(){
		ctx.moveTo(0,0) ;
		for ( var i = 0 ; i < NodeList.length ; i ++ ){
			DrawCoupleLine(i) ;
			DrawChildrenLine(i) ;
		}
	};

	var DrawTogether = function(){
	};

	var Init = function(){
		NodeList = new Array();
		HighestList = new Array();
		var Me = new Node(0);
		Me.x = (c.width)/2;
		Me.y = (c.height)/2 ;
		Me.me = false ;
		NodeList.push(Me) ;
		NowId = 0 ;
{#		InsertCouple();#}
{#		InsertChildBack();#}
{#		InsertParent();#}
{#		NowId = 1 ;#}
{#		InsertParent();#}
{#		NowId = null ;#}
{#		HighestList[0] = 5 ;#}
{#		HighestList[1] = 3 ;#}
{#		HighestLeft = HighestRight = SecondLeft = SecondRight = LowestLeft = LowestRight = null ;#}
		Paint();
	};

	window.onload = function(){

		Init();
{#        $('#edit').hDialog();#}
	}

</script>
    <script>
$(function(){


	//带标题的
	$('.demo0').hDialog({title: '测试弹框标题',height: 300});

	//改变宽度
	$('.demo').hDialog({width: 500});

	//改变高度
	$('.demo2').hDialog({height: 400});

	//改变宽和高
	$('.demo3').hDialog({width:600,height: 500});

	//改变位置
	$('.demo4').hDialog({positions: 'top'});

	//不清空表单
	$('.demo5').hDialog({resetForm: false});

	//遮罩不可关闭
	$('.demo6').hDialog({modalHide: false});

	//改变弹框背景色
	$('.demo7').hDialog({boxBg: '#eeeeee'});

	//改变遮罩背景色
	$('.demo8').hDialog({modalBg: 'rgba(255,255,255,0.7)'});

	//改变关闭背景色
	$('.demo9').hDialog({closeBg: '#4A74B5'});

	//错误文字提示
	$('.demo10').click(function(){
		$.tooltip('My God, 出错啦！！！');
	});

	//正确文字提示
	$('.demo11').click(function(){
		$.tooltip('OK, 操作成功！', 2500, true);
	});

	//显示加载
	$('.demo12').click(function(){
		//自定义文字： $.showLoading('玩命加载中...');
		//自定义宽高： $.showLoading('努力加载中...',140,40);
		$.showLoading();
	});

	//移除加载
	$('.demo13').click(function(){
		$.hideLoading();
	});

	//显示前的回调方法
	$('.demo14').hDialog({beforeShow: function(){
		alert('显示前执行');
	}});

	//隐藏后的回调方法
	$('.demo15').hDialog({afterHide: function(){
		alert('隐藏后执行');
	}});

	//fadeOut淡出关闭效果
	$('.demo16').hDialog({effect: 'fadeOut'});

	//悬浮触发
	$('.demo17').hDialog({triggerEvent: 'mouseenter'});

	//不显示关闭按钮
	$('.demo18').hDialog({closeHide: false});

	//提交并验证表单
	$('.submitBtn').click(function() {
		var EmailReg = /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/; //邮件正则
		var PhoneReg = /^0{0,1}(13[0-9]|15[0-9]|153|156|18[7-9])[0-9]{8}$/ ; //手机正则
		var $nickname = $('.nickname');
		var $email = $('.email');
		var $phone = $('.phone');
		if($nickname.val() == ''){
			$.tooltip('昵称还没填呢...'); $nickname.focus();
		}else if($phone.val() == ''){
			$.tooltip('手机还没填呢...'); $phone.focus();
		}else if(!PhoneReg.test($phone.val())){
			$.tooltip('手机格式错咯...'); $phone.focus();
		}else if($email.val() == ''){
			$.tooltip('邮箱还没填呢...'); $email.focus();
		}else if(!EmailReg.test($email.val())){
			$.tooltip('邮箱格式错咯...'); $email.focus();
		}else{
            console.log('提交数据');
            $.ajax({
                type: 'POST',
                url: '/editperson/',
                data:$('#form').serialize(),
                success:function(){
                    console.log('success');
                    console.log($('#form').serialize());
                },
                error:function(){
                    console.log('error');
                }

            });
			$.tooltip('提交成功，2秒后自动关闭',2000,true);
			setTimeout(function(){
				//$el.hDialog('close',{box:'#HBox'},'http://smwell.sinaapp.com/');  //也可以加跳转链接哦~
                $('.demo6').hDialog('close',{box:'#HBox'});
			},2000);
		}
	});

{#	$('body').append('<footer style="width:100%;background-color:#eeeeee;border-top:1px solid #ccc;padding:12px 0;text-align:center;color:#999;">&copy;2014 <a target="_blank" href="http://smwell.sinaapp.com/">haibao</a>, All Rights Reserved.</footer>');#}
});
</script>
{% block js %}
{% endblock %}
{#<script>#}
{#    var myChart = echarts.init(document.getElementById('meminfo'));#}
{#    option = {#}
{#		backgroundColor: "white",#}
{#		tooltip: {#}
{#			formatter: "{a} <br/>{b} : {c}%"#}
{#		},#}
{#		toolbox: {#}
{#			feature: {#}
{#				restore: {},#}
{#				saveAsImage: {}#}
{#			}#}
{#		},#}
{#		series: [{#}
{#			name: '内存使用率',#}
{#			type: 'gauge',#}
{#			detail: {#}
{#				formatter: '{value}%'#}
{#			},#}
{#			data: [{#}
{#				value: 50,#}
{#				name: '内存使用率'#}
{#			}]#}
{#		}]#}
{#	};#}
{#    setInterval(function () {#}
{#        option.series[0].data[0].value = (Math.random() * 100).toFixed(2) - 0;#}
{#        myChart.setOption(option, true);#}
{#    },2000);#}

{#</script>#}

</body>
</html>